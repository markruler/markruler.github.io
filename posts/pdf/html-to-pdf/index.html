<!DOCTYPE html>
<html lang="ko"><head>

<title>
  
  임창수
  
  | Playwright를 사용해서 HTML 페이지를 PDF로 만들기
  
  
</title>




<meta charset="utf-8">
<meta name="X-UA-Compatible" content="IE=edge">
<meta name="google-site-verification" content="G-FFMDWZ27TN">
<meta content="width=device-width, initial-scale=1.0, maximum-scale=5, user-scalable=5" name="viewport">
<meta content="telephone=no" name="format-detection">
<meta name="description" content="HTML to PDF">
<meta name="renderer" content="webkit">
<meta name="theme-color" content="#ffffff">
<link rel="manifest" href="/manifest.json">



<meta property="og:url" content="https://markruler.github.io/posts/pdf/html-to-pdf/">
  <meta property="og:site_name" content="임창수">
  <meta property="og:title" content="Playwright를 사용해서 HTML 페이지를 PDF로 만들기">
  <meta property="og:description" content="HTML to PDF">
  <meta property="og:locale" content="ko_kr">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-12-12T22:02:00+09:00">
    <meta property="article:modified_time" content="2024-12-10T20:38:00+09:00">
    <meta property="article:tag" content="Web">
    <meta property="article:tag" content="Pdf">
    <meta property="og:image" content="https://markruler.github.io/images/pdf/htmltopdf/htmltopdf.webp">






  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://markruler.github.io/images/pdf/htmltopdf/htmltopdf.webp">
  <meta name="twitter:title" content="Playwright를 사용해서 HTML 페이지를 PDF로 만들기">
  <meta name="twitter:description" content="HTML to PDF">







      <script async src="https://www.googletagmanager.com/gtag/js?id=G-FFMDWZ27TN"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-FFMDWZ27TN');
        }
      </script>






  




<link rel="icon" href="https://markruler.github.io/images/favicon.ico">



      <script src="/js/toc.js"></script>
    
    <link type="text/css" rel="stylesheet" href="/vendor/css/bootstrap.min.css">

<link rel="stylesheet" href="/scss/dark-mode.min.6fb1a4d9e434f0567d24150b692bfd630223dcdbfa6bf50fb98e75b8540930d8.css" integrity="sha256-b7Gk2eQ08FZ9JBULaSv9YwIj3Nv6a/UPuY51uFQJMNg=" media="screen">


<link rel="stylesheet"
          href="https://fonts.googleapis.com/css?family=Material+Icons">



















</head>
<body>
    	<div id="app"><div class="single-column-drawer-container" id="drawer"
     v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }">
    <div class="drawer-content">
        <div class="drawer-menu">
            
            
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/about">
                    About
                </a>
                
            
                
                
                
                    
                
                
                
                <a class="a-block drawer-menu-item active" href="/posts">
                    Posts
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/categories">
                    Categories
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/tags">
                    Tags
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/index.xml">
                    RSS Feed
                </a>
                
            
            
            <div class="toc">


	<div class="toc-content">
	
		
		
		
		<center>- 목차 -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%ea%b0%9c%ec%9a%94" class="nav-개요">
									개요
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#1%ec%b0%a8-%ec%8b%9c%eb%8f%84-wkhtmltopdf" class="nav-1차-시도-wkhtmltopdf">
									1차 시도: wkhtmltopdf
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#2%ec%b0%a8-%ec%8b%9c%eb%8f%84-pyppeteer" class="nav-2차-시도-pyppeteer">
									2차 시도: pyppeteer
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#windowprint%eb%a1%9c-%ec%b6%9c%eb%a0%a5" class="nav-windowprint로-출력">
									window.print()로 출력
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#pyppeteer%eb%a1%9c-%ec%b6%9c%eb%a0%a5" class="nav-pyppeteer로-출력">
									Pyppeteer로 출력
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#3%ec%b0%a8-%ec%8b%9c%eb%8f%84-microsoftplaywright" class="nav-3차-시도-microsoftplaywright">
									3차 시도: microsoft/playwright
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%ea%b5%ac%ed%98%84-%ec%8b%9c-%ec%b0%b8%ea%b3%a0-%ec%82%ac%ed%95%ad" class="nav-구현-시-참고-사항">
									구현 시 참고 사항
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%ec%b0%b8%ec%a1%b0" class="nav-참조">
									참조
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#playwright" class="nav-playwright">
									Playwright
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#webkit" class="nav-webkit">
									WebKit
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#chromium" class="nav-chromium">
									Chromium
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
            
        </div>
    </div>
</div>
<transition name="fade">
    <div id="drawer-mask" v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if="isDrawerOpen" v-on:click="toggleDrawer"></div>
</transition>
<nav id="navBar" class="navbar sticky-top navbar-light single-column-nav-container">
    <div id="navBackground" class="nav-background"></div>
    <div class="container container-narrow nav-content">
        <button id="nav_dropdown_btn" class="nav-dropdown-toggle" type="button" v-on:click="toggleDrawer">
            <i class="material-icons">
                menu
            </i>
        </button>
        <a id="navTitle" class="navbar-brand" href="https://markruler.github.io/">
            임창수
        </a>
        
        <button type="button" class="nav-darkmode-toggle" id="darkModeToggleButton2">
            <i class="material-icons" id="darkModeToggleIcon2">
                dark_mode
            </i>
        </button>
        
    </div>
</nav>
<div class="single-column-header-container" id="pageHead"
     v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }">
    <button
        class="read-random-mobile"
        data-target-prefix="/posts">
        Navigate to Random Post
    </button>
    <a href="https://markruler.github.io/">
        <div class="single-column-header-title">임창수</div>
        
        <div class="single-column-header-subtitle">What, Why, How.</div>
        

    </a>
</div>

            <div id="content">
                <div id="streamContainer" class="stream-container">

    <div class="post-list-container post-list-container-shadow">
        <div class="post">
            
            
            
                
            

            <div class="post-head-wrapper"
                
                    
                    
                    style="background-image: url('https://markruler.github.io/images/pdf/htmltopdf/htmltopdf.webp')"
                    
                
            >
                <div class="post-title">
                    Playwright를 사용해서 HTML 페이지를 PDF로 만들기
                    
                    <div class="post-subtitle">
                        HTML to PDF
                    </div>
                    
                    <div class="post-meta">
                        
                        <time itemprop="datePublished">
                            2023-12-12 22:02
                        </time>
                        

                        
                            <i class="material-icons" style="">folder</i>
                                <a href="/categories/wiki">[wiki]</a>
                                &nbsp;
                        

                        
                            <i class="material-icons" style="">label</i>
                            
                                <a href="/tags/web">web</a>
                                &nbsp;
                            
                                <a href="/tags/pdf">pdf</a>
                                &nbsp;
                            
                        
                        
                    </div>
                </div>
            </div>
            
            <div class="post-body-wrapper">
                
                <div class="post-body" v-pre>
                
                    <blockquote>
<p>데모 서버는 <a href="https://github.com/markruler/htmltopdf">markruler/htmltopdf</a> 저장소를 사용해주세요.</p>
</blockquote>
<h1 id="개요">개요</h1>
<p>팀내에서 문서 생성 도구로 <a href="https://pdfmyurl.com/html-to-pdf-api">PDFmyURL</a>과
<a href="https://www.forcs.com/kr/oz-e-form/">OZ e-Form</a>을 사용하고 있다.
보통 이런 외부 솔루션은 테스트 할 때 매우 불편하다.</p>
<p>PDFmyURL은 PDF를 생성하는 2가지 인터페이스가 있다.
하나는 URL을 통해 페이지를 읽어서 PDF를 생성하는 인터페이스고,
하나는 raw HTML, CSS를 직접 전달해서 PDF를 생성하는 인터페이스다.
URL 방식은 PDFmyURL 측 서버(서비스 외부)에서 페이지를 조회할 수 있어야 한다.
그래서 private 환경에서는 테스트 할 수가 없다.
그래서 해당 기능들은 운영 환경에서 QA 테스트를 해야 하는 불상사가 생긴다.
더 큰 문제는 데이터를 Public 환경에 노출해야 하기 때문에
데이터에 따라 개인 정보 유출 문제가 될 수 있다.</p>
<p>OZ e-Form의 클라이언트 프로그램(OZ e-Form Designer)은 Windows만 지원한다.
그리고 OZ 에이전트와 script를 적극적으로 관리할 인력이 없다.
해당 기술은 활용도가 떨어지기 때문에 관심이 적을 수 밖에 없기 때문이다.</p>
<p>그러다가 누군가의 실수로 PDFmyURL 서버에 동시에 수많은 요청을 보내게 되었다.
그러자 PDFmyURL은 우리를 차단해버렸다.
문의를 남겨도 해외 서비스라 그런지 대응이 느렸고,
PDFmyURL을 이용하는 서비스가 반나절동안 중단되었다.
언제 해결될지 기약이 없었다.
결국 다른 계정으로 라이센스를 추가 발급받아 해결했다.</p>
<p>내부에서 관리 가능한 HTML to PDF 변환 도구가 간절하다고 느낀 시기였다.</p>
<h1 id="1차-시도-wkhtmltopdf">1차 시도: wkhtmltopdf</h1>
<p>이런 프로그램을 제작해 본 경험자가 없어서 막연히 ChatGPT에게 물어봤다.
가장 먼저 답변해준 방법은 <a href="https://wkhtmltopdf.org/">wkhtmltopdf</a> 였다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2;display:grid;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#0f0"># 해당 도구는 한글을 출력하기 위해 한글 폰트를 별도 설치해야 했다.</span>
</span></span><span style="display:flex;"><span>apt-get -y install fonts-nanum wkhtmltopdf
</span></span></code></pre></div><p>빠르게 시작하기 위해 Python의 <code>pdfkit</code>과
오픈 소스 PDF 변환 툴인 <code>wkhtmltopdf</code>를 사용해서 Flask 앱을 만들었다.
하지만 기존 출력물(크롬에서 <a href="https://html.spec.whatwg.org/multipage/timers-and-user-prompts.html#printing">window.print()</a>)과
달리 PDF 출력물을 보면 CSS가 틀어지는 부분이 너무 많았다.</p>
<p>리뷰하는 과정에서 확인해보니 문서를 읽지 않은 내 잘못이었다.
해당 홈페이지 첫 문장부터 <code>Qt WebKit rendering engine</code> 이라고 설명한다.
<code>wk</code>는 WebKit의 약자였고, Qt WebKit을 기반으로 변환하다보니
Chromium 기반으로 작성되어 있는 HTML이 그대로 보일 리 없었다.</p>
<blockquote>
<p><strong><a href="https://en.wikipedia.org/wiki/Comparison_of_browser_engines">Comparison of browser engines</a></strong> - Wikipedia</p>
</blockquote>
<h1 id="2차-시도-pyppeteer">2차 시도: pyppeteer</h1>
<p>기존에 Python으로 작성된 코드를 재사용하려고 Javascript 기반의 <a href="https://github.com/puppeteer/puppeteer">puppeteer</a>
대신 python 기반의 <a href="https://github.com/pyppeteer/pyppeteer">pyppeteer</a>을 사용했다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2;display:grid;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#0f0"># Ubuntu 22.04에서 google-chrome 명령어 설치</span>
</span></span><span style="display:flex;"><span>apt-get update <span style="color:#87ceeb">\
</span></span></span><span style="display:flex;"><span><span style="color:#87ceeb"></span>    &amp;&amp; apt-get install -y wget gnupg <span style="color:#87ceeb">\
</span></span></span><span style="display:flex;"><span><span style="color:#87ceeb"></span>    &amp;&amp; wget -q -O - https://dl-ssl.google.com/linux/linux_signing_key.pub | gpg --dearmor -o /usr/share/keyrings/googlechrome-linux-keyring.gpg <span style="color:#87ceeb">\
</span></span></span><span style="display:flex;"><span><span style="color:#87ceeb"></span>    &amp;&amp; sh -c <span style="color:#87ceeb">&#39;echo &#34;deb [arch=amd64 signed-by=/usr/share/keyrings/googlechrome-linux-keyring.gpg] http://dl.google.com/linux/chrome/deb/ stable main&#34; &gt;&gt; /etc/apt/sources.list.d/google.list&#39;</span> <span style="color:#87ceeb">\
</span></span></span><span style="display:flex;"><span><span style="color:#87ceeb"></span>    &amp;&amp; apt-get update <span style="color:#87ceeb">\
</span></span></span><span style="display:flex;"><span><span style="color:#87ceeb"></span>    &amp;&amp; apt-get install -y google-chrome-stable fonts-ipafont-gothic fonts-wqy-zenhei fonts-thai-tlwg fonts-khmeros fonts-kacst fonts-freefont-ttf libxss1 <span style="color:#87ceeb">\
</span></span></span><span style="display:flex;"><span><span style="color:#87ceeb"></span>      --no-install-recommends <span style="color:#87ceeb">\
</span></span></span><span style="display:flex;"><span><span style="color:#87ceeb"></span>    &amp;&amp; rm -rf /var/lib/apt/lists/* <span style="color:#87ceeb">\
</span></span></span><span style="display:flex;"><span><span style="color:#87ceeb"></span>    &amp;&amp; groupadd -r pptruser &amp;&amp; useradd -rm -g pptruser -G audio,video pptruser
</span></span></code></pre></div><p><code>google-chrome</code>을 headless 모드로 실행해서 프린트하면
출력물이 브라우저 프린트(<code>window.print()</code>)와 동일하게 나왔다.
(팀원 모두 Edge 아니면 Chrome을 사용함)
또한 private 환경에서도 출력할 수 있게 되었다.</p>
<h2 id="windowprint로-출력">window.print()로 출력</h2>
<p><img src="/images/pdf/htmltopdf/window.print.webp" alt="window.print() - google.com"></p>
<h2 id="pyppeteer로-출력">Pyppeteer로 출력</h2>
<p><img src="/images/pdf/htmltopdf/pyppeteer.print.webp" alt="pyppeteer - google.com"></p>
<h1 id="3차-시도-microsoftplaywright">3차 시도: microsoft/playwright</h1>
<p>URL이 아닌 Raw HTML, Raw CSS를 전달해서 PDF를 출력하는 기능도 지원되어야 했다.
p<strong>y</strong>ppeteer에선 HTML Content를 렌더링 할 때 Load 되는 것을 기다리지 않아서
이미지 렌더링(img src, background url 등)이 되지 않았다.</p>
<ul>
<li><code>setContent()</code> 시 <code>waitUntil</code> 옵션을 p<strong>u</strong>ppeteer만 지원하고 있다.
<ul>
<li><a href="https://github.com/puppeteer/puppeteer/issues/907#issuecomment-472334126">page.setContent(html, {waitUntil: &rsquo;networkidle&rsquo;}); · Issue #907 · puppeteer/puppeteer</a></li>
<li><a href="https://github.com/miyakogi/pyppeteer/issues/211">setContent extra options · Issue #211 · miyakogi/pyppeteer</a></li>
</ul>
</li>
</ul>
<p>반면 <a href="https://github.com/microsoft/playwright-python">Microsoft의 playwright</a>는 해당 기능들을
모두 지원하면서, Javascript는 물론 Python도 지원했다.
결국 Content로 PDF를 출력하는 기능도 지원하기 위해 playwright로 변경했다.
<a href="https://playwright.dev/docs/puppeteer">puppeteer와 인터페이스를 유사하게 만들었기</a>
때문에 변경하는 데에 많은 리소스가 들지 않았다.</p>
<p>다음은 간단한 Raw Content를 PDF로 출력하는 토막 코드다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2;display:grid;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#0f0"># python3 -m pip install playwright</span>
</span></span><span style="display:flex;"><span><span style="color:#0f0"># python3 -m playwright install chromium  # Download to $HOME/.cache/ms-playwright/</span>
</span></span><span style="display:flex;"><span><span style="color:#0f0"># python3 main.py</span>
</span></span><span style="display:flex;"><span><span style="color:#f00">import</span> logging
</span></span><span style="display:flex;"><span><span style="color:#f00">import</span> asyncio
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f00">from</span> playwright.async_api <span style="color:#f00">import</span> async_playwright, Playwright, PlaywrightContextManager, Browser, BrowserContext
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f00">async</span> <span style="color:#f00">def</span> <span style="color:#ff0">core_file</span>():
</span></span><span style="display:flex;"><span>    playwright_context_manager: PlaywrightContextManager = async_playwright()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#0f0"># https://playwright.dev/python/docs/api/class-playwright</span>
</span></span><span style="display:flex;"><span>    playwright: Playwright = <span style="color:#f00">await</span> playwright_context_manager.start()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#0f0"># https://playwright.dev/python/docs/api/class-browsertype#browser-type-launch</span>
</span></span><span style="display:flex;"><span>    browser: Browser = <span style="color:#f00">await</span> playwright.chromium.launch(
</span></span><span style="display:flex;"><span>        headless=<span style="color:#f00">True</span>,
</span></span><span style="display:flex;"><span>        timeout=<span style="color:#f60">10_000</span>,  <span style="color:#0f0"># (ms)</span>
</span></span><span style="display:flex;"><span>        args=[
</span></span><span style="display:flex;"><span>            <span style="color:#0f0"># https://peter.sh/experiments/chromium-command-line-switches/</span>
</span></span><span style="display:flex;"><span>            <span style="color:#87ceeb">&#34;--no-sandbox&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#87ceeb">&#34;--single-process&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#87ceeb">&#34;--disable-dev-shm-usage&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#87ceeb">&#34;--disable-gpu&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#87ceeb">&#34;--no-zygote&#34;</span>,
</span></span><span style="display:flex;"><span>        ],
</span></span><span style="display:flex;"><span>        <span style="color:#0f0"># avoid &#34;signal only works in main thread of the main interpreter&#34;</span>
</span></span><span style="display:flex;"><span>        handle_sigint=<span style="color:#f00">False</span>,
</span></span><span style="display:flex;"><span>        handle_sigterm=<span style="color:#f00">False</span>,
</span></span><span style="display:flex;"><span>        handle_sighup=<span style="color:#f00">False</span>,
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#0f0"># https://playwright.dev/python/docs/api/class-browser#browser-new-context</span>
</span></span><span style="display:flex;"><span>    logging.debug(<span style="color:#87ceeb">&#39;new_context:new_page&#39;</span>)
</span></span><span style="display:flex;"><span>    context: BrowserContext = <span style="color:#f00">await</span> browser.new_context()
</span></span><span style="display:flex;"><span>    page = <span style="color:#f00">await</span> context.new_page()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#0f0"># https://playwright.dev/python/docs/api/class-page#page-goto</span>
</span></span><span style="display:flex;"><span>    logging.debug(<span style="color:#87ceeb">&#39;set_content&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#f00">await</span> page.set_content(
</span></span><span style="display:flex;"><span>        html=<span style="color:#87ceeb">&#39;&lt;div&gt;&lt;span&gt;Test&lt;/span&gt; Text&lt;/div&gt;&#39;</span>,
</span></span><span style="display:flex;"><span>        timeout=<span style="color:#f60">10_000</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#0f0"># load로 해야 img.src가 로드됨.</span>
</span></span><span style="display:flex;"><span>        wait_until=<span style="color:#87ceeb">&#39;load&#39;</span>  <span style="color:#0f0"># domcontentloaded, load, networkidle</span>
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    logging.info(<span style="color:#87ceeb">&#39;add_style_tag&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#f00">await</span> page.add_style_tag(
</span></span><span style="display:flex;"><span>        content=<span style="color:#87ceeb">&#39;span{color:red;}&#39;</span>
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#0f0"># https://playwright.dev/python/docs/api/class-page#page-pdf</span>
</span></span><span style="display:flex;"><span>    logging.debug(<span style="color:#87ceeb">&#39;Generate PDF&#39;</span>)
</span></span><span style="display:flex;"><span>    _pdf = <span style="color:#f00">await</span> page.pdf(
</span></span><span style="display:flex;"><span>        format=<span style="color:#87ceeb">&#39;A4&#39;</span>,
</span></span><span style="display:flex;"><span>        landscape=<span style="color:#f00">False</span>,
</span></span><span style="display:flex;"><span>        print_background=<span style="color:#f00">True</span>,
</span></span><span style="display:flex;"><span>        display_header_footer=<span style="color:#f00">False</span>,
</span></span><span style="display:flex;"><span>        margin={
</span></span><span style="display:flex;"><span>            <span style="color:#87ceeb">&#39;top&#39;</span>: <span style="color:#87ceeb">&#39;10mm&#39;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#87ceeb">&#39;bottom&#39;</span>: <span style="color:#87ceeb">&#39;10mm&#39;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#87ceeb">&#39;left&#39;</span>: <span style="color:#87ceeb">&#39;10mm&#39;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#87ceeb">&#39;right&#39;</span>: <span style="color:#87ceeb">&#39;10mm&#39;</span>,
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    print(_pdf)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f00">await</span> context.close()  <span style="color:#0f0"># don&#39;t forget to close the context, or it will create a core.{number} file.</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f00">await</span> browser.close()
</span></span><span style="display:flex;"><span>    <span style="color:#f00">await</span> playwright.stop()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#0f0"># python3 main.py</span>
</span></span><span style="display:flex;"><span><span style="color:#f00">if</span> __name__ == <span style="color:#87ceeb">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    asyncio.run(core_file())
</span></span></code></pre></div><h1 id="구현-시-참고-사항">구현 시 참고 사항</h1>
<ul>
<li>CSS attribute 중 <code>page-break-***</code> 를 사용하면 페이지를 원하는 부분에서 분리할 수 있다.
<ul>
<li><code>page-break-after: always;</code> 해당 Element 이후에 내용이 있더라도 페이지를 분리한다.</li>
<li><code>page-break-after: avoid;</code> 해당 Element 이후에 페이지는 분리하지 않는다. 이후 내용이 페이지를 넘친다면 페이지 분리되긴 한다.</li>
</ul>
</li>
<li>PDF 생성 후 응답되기까지 2초 정도 소요된다.
<ul>
<li>PDFmyURL, OZ report와 비슷하다.</li>
<li>1주일 기준
<ul>
<li>P50: 2.01s</li>
<li>P95: 2.83s</li>
</ul>
</li>
</ul>
</li>
<li>Server to Server로 요청 시 Spring Boot에서 FeignClient로
<a href="https://wildeveloperetrain.tistory.com/304">x-www-form-urlencoded</a>
데이터를 보내려면 <code>MultiValueMap&lt;String, String&gt;</code>을 사용해야 한다.</li>
</ul>
<h1 id="참조">참조</h1>
<h2 id="playwright"><strong>Playwright</strong></h2>
<ul>
<li><a href="https://playwright.dev/python/">공식 문서</a></li>
<li><a href="https://github.com/microsoft/playwright-python">GitHub</a></li>
<li><a href="https://devocean.sk.com/blog/techBoardDetail.do?ID=165090">웹 테스트 자동화</a>가 목적인 라이브러리임.</li>
</ul>
<h2 id="webkit"><strong>WebKit</strong></h2>
<ul>
<li><a href="https://wkhtmltopdf.org/">wkhtmltopdf</a></li>
</ul>
<h2 id="chromium"><strong>Chromium</strong></h2>
<ul>
<li><a href="https://developer.chrome.com/articles/new-headless/">Chrome’s Headless mode gets an upgrade: introducing &ndash;headless=new | Chromium | Chrome for Developers</a></li>
</ul>

                    
                    <HR width="100%" id="EOF">
		    <p style="color:#777;">최종 수정: 2024-12-10</p>
                    
                </div>
            </div>
            
            
            <nav class="post-pagination">

                
                <a class="newer-posts" href="/posts/network/server-to-server-dns/">
			다음글<br>서버 to 서버 요청 시 발생한 DNS 레이턴시
                </a>
                
                
                
                <a class="older-posts" href="/posts/db/oracle-dbms-session-diagnosis/">
			이전글<br>오라클 DBMS SE2 세션 사후 진단
                </a>
                
            </nav>
            <div class="post-comment-wrapper">
                












            </div>

            





<section class="social-share">
  <ul class="share-icons">
    
    
    <li>
      <a href="https://twitter.com/intent/tweet?hashtags=markruler,dev&amp;url=https%3a%2f%2fmarkruler.github.io%2fposts%2fpdf%2fhtml-to-pdf%2f&amp;text=Playwright%eb%a5%bc%20%ec%82%ac%ec%9a%a9%ed%95%b4%ec%84%9c%20HTML%20%ed%8e%98%ec%9d%b4%ec%a7%80%eb%a5%bc%20PDF%eb%a1%9c%20%eb%a7%8c%eb%93%a4%ea%b8%b0" target="_blank" rel="noopener" aria-label="Share on Twitter" class="share-btn twitter">
        <svg xmlns:xlink="http://www.w3.org/1999/xlink" id="twitter" viewBox="0 0 48 48" overflow="hidden">
  <defs></defs>
  <g style="pointer-events:all">
    <title style="pointer-events:inherit">bg</title>
    <circle cx="24" cy="24" fill="#1CB7EB" r="24" style="pointer-events:inherit" id="svg_1"></circle>
    <path d="M36.8,15.4C35.9,15.9 34.8,16.2 33.8,16.3C34.9,15.6 35.7,14.5 36.1,13.2C35.1,13.8 34,14.3 32.7,14.6C31.7,13.5 30.4,12.8 28.9,12.8C26,12.8 23.6,15.3 23.6,18.5C23.6,18.9 23.6,19.4 23.7,19.8C19.3,19.6 15.4,17.3 12.8,13.9C12.3,14.7 12.1,15.7 12.1,16.8C12.1,18.8 13,20.5 14.4,21.5C13.5,21.5 12.7,21.2 12,20.8C12,20.8 12,20.9 12,20.9C12,23.6 13.8,25.9 16.2,26.5C15.8,26.6 15.3,26.7 14.8,26.7C14.5,26.7 14.1,26.7 13.8,26.6C14.5,28.9 16.4,30.5 18.7,30.5C16.9,32 14.6,32.9 12.2,32.9C11.8,32.9 11.4,32.9 10.9,32.8C13.2,34.4 16,35.4 19,35.4C28.7,35.4 34,26.8 34,19.3C34,19.1 34,18.8 34,18.6C35.2,17.6 36.1,16.6 36.8,15.4z" fill="#FFFFFF" style="pointer-events:inherit" id="svg_4"></path>
  </g>
</svg>
        <p>Twitter</p>
      </a>
    </li>
    

    
    
    <li>
      <a href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fmarkruler.github.io%2fposts%2fpdf%2fhtml-to-pdf%2f" target="_blank" rel="noopener" aria-label="Share on Facebook" class="share-btn facebook">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" enable-background="new 0 0 48 48" id="facebook" version="1.1" viewBox="0 0 48 48" xml:space="preserve">
  <circle cx="24" cy="24" fill="#4E71A8" r="24" />
  <path d="M29.9,19.5h-4v-2.6c0-1,0.7-1.2,1.1-1.2c0.5,0,2.8,0,2.8,0v-4.4l-3.9,0c-4.4,0-5.3,3.3-5.3,5.3v2.9h-2.5V24  h2.5c0,5.8,0,12.7,0,12.7h5.3c0,0,0-7,0-12.7h3.6L29.9,19.5z" fill="#FFFFFF" />
</svg>
        <p>Facebook</p>
        </a>
    </li>
    

    
    

    
    

    
    
    <li>
      <a href="mailto:?subject=%ec%9e%84%ec%b0%bd%ec%88%98 - Playwright%eb%a5%bc%20%ec%82%ac%ec%9a%a9%ed%95%b4%ec%84%9c%20HTML%20%ed%8e%98%ec%9d%b4%ec%a7%80%eb%a5%bc%20PDF%eb%a1%9c%20%eb%a7%8c%eb%93%a4%ea%b8%b0.&amp;body=Playwright%eb%a5%bc%20%ec%82%ac%ec%9a%a9%ed%95%b4%ec%84%9c%20HTML%20%ed%8e%98%ec%9d%b4%ec%a7%80%eb%a5%bc%20PDF%eb%a1%9c%20%eb%a7%8c%eb%93%a4%ea%b8%b0%2c%20by%20%ec%9e%84%ec%b0%bd%ec%88%98%0aHTML%20to%20PDF%0a%0ahttps%3a%2f%2fmarkruler.github.io%2fposts%2fpdf%2fhtml-to-pdf%2f%0a" target="_blank" class="share-btn email">
        <svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" id="email" overflow="hidden">
  <defs></defs>
  <g style="pointer-events:none">
    <title style="pointer-events:inherit">background</title>
    <rect x="-1" y="-1" width="582" height="402" id="canvas_background" fill="none" style="pointer-events:inherit"></rect>
  </g>
  <g style="pointer-events:all">
    <title style="pointer-events:inherit">Layer 1</title>
    <path d="M16,0C7.163,0 0,7.163 0,16C0,24.836 7.163,32 16,32S32,24.836 32,16C32,7.163 24.837,0 16,0z" fill="#333333" style="pointer-events:inherit" id="svg_2"></path>
    <polygon fill="#FFFFFF" points="6.518,21.815 11.707,15.291 6.518,12.119   " style="pointer-events:inherit" id="svg_4"></polygon>
    <polygon fill="#FFFFFF" points="19.5,15.746 15.989,17.908 12.472,15.758 7.11,22.5 24.867,22.5   " style="pointer-events:inherit" id="svg_5"></polygon>
    <polygon fill="#FFFFFF" points="15.988,16.864 25.482,11.017 25.482,9.5 6.518,9.5 6.518,11.076   " style="pointer-events:inherit" id="svg_6"></polygon>
    <polygon fill="#FFFFFF" points="20.263,15.276 25.482,21.843 25.482,12.062   " style="pointer-events:inherit" id="svg_7"></polygon>
  </g>
</svg>
        <p>Email</p>
      </a>
    </li>
  </ul>
</section>


        </div>
    </div>


                    </div>
            </div><div id="sideContainer" class="side-container">
    
    <a class="a-block nav-head false" href="https://markruler.github.io/">
    
        <div class="nav-title">
            임창수
        </div>
        
        <div class="nav-subtitle">
            What, Why, How.
        </div>
        
    </a>

    <div class="nav-link-list">
        
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/about">
                About
            </a>
            
        
            
            
            
                
            
            
            
            <a class="a-block nav-link-item active" href="/posts">
                Posts
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/categories">
                Categories
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/tags">
                Tags
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/index.xml">
                RSS Feed
            </a>
            
        
        <a
            class="read-random a-block nav-link-item false"
            data-target-prefix="/posts">
            Navigate to Random Post
        </a>
    </div>

    <div class="nav-footer">
        


Hugo Theme <a style="color: #0054B8; text-decoration: underline;" href="https://github.com/amazingrise/hugo-theme-diary">Diary</a>
by <a style="color: #0054B8; text-decoration: underline;" href="https://risehere.net/">Rise</a>
<br>
Ported from <a style="color: #0054B8; text-decoration: underline;" href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a>'s
<a style="color: #0054B8; text-decoration: underline;" href="https://github.com/SumiMakito/hexo-theme-journal/" target="_blank" rel="noreferrer noopener">Journal.</a> <br>
<br>

&copy;
	
	Im Changsu 2020 - 2024
	

    </div>
    
</div><div id="extraContainer" class="extra-container">
    <div class="toc-wrapper">
        

        
        <div class="toc">


	<div class="toc-content">
	
		
		
		
		<center>- 목차 -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%ea%b0%9c%ec%9a%94" class="nav-개요">
									개요
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#1%ec%b0%a8-%ec%8b%9c%eb%8f%84-wkhtmltopdf" class="nav-1차-시도-wkhtmltopdf">
									1차 시도: wkhtmltopdf
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#2%ec%b0%a8-%ec%8b%9c%eb%8f%84-pyppeteer" class="nav-2차-시도-pyppeteer">
									2차 시도: pyppeteer
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#windowprint%eb%a1%9c-%ec%b6%9c%eb%a0%a5" class="nav-windowprint로-출력">
									window.print()로 출력
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#pyppeteer%eb%a1%9c-%ec%b6%9c%eb%a0%a5" class="nav-pyppeteer로-출력">
									Pyppeteer로 출력
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#3%ec%b0%a8-%ec%8b%9c%eb%8f%84-microsoftplaywright" class="nav-3차-시도-microsoftplaywright">
									3차 시도: microsoft/playwright
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%ea%b5%ac%ed%98%84-%ec%8b%9c-%ec%b0%b8%ea%b3%a0-%ec%82%ac%ed%95%ad" class="nav-구현-시-참고-사항">
									구현 시 참고 사항
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%ec%b0%b8%ec%a1%b0" class="nav-참조">
									참조
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#playwright" class="nav-playwright">
									Playwright
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#webkit" class="nav-webkit">
									WebKit
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#chromium" class="nav-chromium">
									Chromium
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
        
    </div>
    <div class="pagination">
        <a id="globalBackToTop" class="pagination-action animated-visibility" href="#top"
            :class="{ invisible: scrollY == 0 }">
            <i class="material-icons pagination-action-icon">
                keyboard_arrow_up
            </i>
        </a>
        
        <a type="button" class="pagination-action" id="darkModeToggleButton">
            <span class="material-icons pagination-action-icon" id="darkModeToggleIcon">
                dark_mode
            </span>
        </a>
        
        
    </div>
</div>

<div id="single-column-footer">


Hugo Theme <a style="color: #0054B8; text-decoration: underline;" href="https://github.com/amazingrise/hugo-theme-diary">Diary</a>
by <a style="color: #0054B8; text-decoration: underline;" href="https://risehere.net/">Rise</a>
<br>
Ported from <a style="color: #0054B8; text-decoration: underline;" href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a>'s
<a style="color: #0054B8; text-decoration: underline;" href="https://github.com/SumiMakito/hexo-theme-journal/" target="_blank" rel="noreferrer noopener">Journal.</a> <br>
<br>

&copy;
	
	Im Changsu 2020 - 2024
	
</div>
            </div>
    
    <script src="/js/journal.js"></script><script src="/js/read-random.js"></script>

    <script>
        
        if ('serviceWorker' in navigator) {
          navigator.serviceWorker.register('/js/sw.js')
            .then(registration => {
              console.log('Service Worker registered with scope:', registration.scope);
            })
            .catch(error => {
              console.log('Service Worker registration failed:', error);
            });
        }
      </script>
    </body>
</html>
