<!DOCTYPE html>
<html lang="ko"><head>
<title>JVM 모니터링</title>




<meta charset="utf-8">
<meta name="X-UA-Compatible" content="IE=edge">
<meta name="google-site-verification" content="G-FFMDWZ27TN">
<meta content="width=device-width, initial-scale=1.0, maximum-scale=5, user-scalable=5" name="viewport">
<meta content="telephone=no" name="format-detection">
<meta name="description" content="이게 왜 죽지..?">
<meta name="renderer" content="webkit">
<meta name="theme-color" content="#ffffff">



<meta property="og:url" content="https://markruler.github.io/posts/java/jvm-monitoring/">
  <meta property="og:site_name" content="임창수">
  <meta property="og:title" content="JVM 모니터링">
  <meta property="og:description" content="이게 왜 죽지..?">
  <meta property="og:locale" content="ko_kr">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2022-05-23T00:09:00+09:00">
    <meta property="article:modified_time" content="2022-05-23T00:09:00+09:00">
    <meta property="article:tag" content="Java">
    <meta property="article:tag" content="Spring">
    <meta property="article:tag" content="Tomcat">
    <meta property="article:tag" content="Monitoring">
    <meta property="og:image" content="https://markruler.github.io/images/java/jvm-monitoring/visualgc-with-visualvm.png">






  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://markruler.github.io/images/java/jvm-monitoring/visualgc-with-visualvm.png">
  <meta name="twitter:title" content="JVM 모니터링">
  <meta name="twitter:description" content="이게 왜 죽지..?">







      <script async src="https://www.googletagmanager.com/gtag/js?id=G-FFMDWZ27TN"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-FFMDWZ27TN');
        }
      </script>






  




<link rel="icon" href="https://markruler.github.io/images/favicon.ico">



      <script src="/js/toc.js"></script>
    
    <link type="text/css" rel="stylesheet" href="/vendor/css/bootstrap.min.css">

<link rel="stylesheet" href="/scss/dark-mode.min.a83c964dd82a93d628a0a9eff3d6dd408b103e32b6000bfa8f385a678bb95109.css" integrity="sha256-qDyWTdgqk9YooKnv89bdQIsQPjK2AAv6jzhaZ4u5UQk=" media="screen">


<link rel="stylesheet"
          href="https://fonts.googleapis.com/css?family=Material+Icons">



















</head>
<body>
    	<div id="app"><div class="single-column-drawer-container" id="drawer"
     v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }">
    <div class="drawer-content">
        <div class="drawer-menu">
            
            
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/about">
                    About
                </a>
                
            
                
                
                
                    
                
                
                
                <a class="a-block drawer-menu-item active" href="/posts">
                    Posts
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/categories">
                    Categories
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/tags">
                    Tags
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/index.xml">
                    RSS Feed
                </a>
                
            
            
            <div class="toc">


	<div class="toc-content">
	
		
		
		
		<center>- 목차 -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#thread-dump" class="nav-thread-dump">
									Thread Dump
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#daemon-thread" class="nav-daemon-thread">
									Daemon Thread
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#tool" class="nav-tool">
									Tool
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#jstack" class="nav-jstack">
									jstack
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#visualvm" class="nav-visualvm">
									VisualVM
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
								</ul>
							
						
						
						
							<li>
								<a href="#heap-dump" class="nav-heap-dump">
									Heap Dump
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#outofmemoryerror" class="nav-outofmemoryerror">
									OutOfMemoryError
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#tool-1" class="nav-tool-1">
									Tool
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#eclipse-memory-analyzer-mat" class="nav-eclipse-memory-analyzer-mat">
									Eclipse Memory Analyzer (MAT)
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#visualvm-1" class="nav-visualvm-1">
									VisualVM
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
								</ul>
							
						
						
						
							<li>
								<a href="#gc-monitoring" class="nav-gc-monitoring">
									GC Monitoring
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#tool-2" class="nav-tool-2">
									Tool
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#jstat" class="nav-jstat">
									jstat
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#visual-gc" class="nav-visual-gc">
									Visual GC
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
								</ul>
							
						
						
						
							<li>
								<a href="#%ed%95%a8%ea%bb%98-%ec%82%ac%ec%9a%a9%ed%95%98%eb%8a%94-%eb%8f%84%ea%b5%ac%eb%93%a4" class="nav-함께-사용하는-도구들">
									함께 사용하는 도구들
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#jdk-tools" class="nav-jdk-tools">
									JDK Tools
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#datadog" class="nav-datadog">
									Datadog
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%ec%9d%b4-%ec%99%b8%ec%9d%98-%eb%8f%84%ea%b5%ac%eb%93%a4" class="nav-이-외의-도구들">
									이 외의 도구들
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%eb%8d%94-%ec%9d%bd%ec%9d%84-%ea%b1%b0%eb%a6%ac" class="nav-더-읽을-거리">
									더 읽을 거리
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#thread-stack" class="nav-thread-stack">
									Thread Stack
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#heap-memory" class="nav-heap-memory">
									Heap Memory
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#garbage-collection" class="nav-garbage-collection">
									Garbage Collection
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%ea%b8%b0%ed%83%80" class="nav-기타">
									기타
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
            
        </div>
    </div>
</div>
<transition name="fade">
    <div id="drawer-mask" v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if="isDrawerOpen" v-on:click="toggleDrawer"></div>
</transition>
<nav id="navBar" class="navbar sticky-top navbar-light single-column-nav-container">
    <div id="navBackground" class="nav-background"></div>
    <div class="container container-narrow nav-content">
        <button id="nav_dropdown_btn" class="nav-dropdown-toggle" type="button" v-on:click="toggleDrawer">
            <i class="material-icons">
                menu
            </i>
        </button>
        <a id="navTitle" class="navbar-brand" href="https://markruler.github.io/">
            임창수
        </a>
        
        <button type="button" class="nav-darkmode-toggle" id="darkModeToggleButton2">
            <i class="material-icons" id="darkModeToggleIcon2">
                dark_mode
            </i>
        </button>
        
    </div>
</nav>
<div class="single-column-header-container" id="pageHead"
     v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }">
    <button
        class="read-random"
        data-target-prefix="/posts">
        Navigate to Random Post
    </button>
    <a href="https://markruler.github.io/">
        <div class="single-column-header-title">임창수</div>
        
        <div class="single-column-header-subtitle">What, Why, How.</div>
        

    </a>
</div>

            <div id="content">
                <div id="streamContainer" class="stream-container">

    <div class="post-list-container post-list-container-shadow">
        <div class="post">
            
            
            
                
            

            <div class="post-head-wrapper"
                
                    
                    
                    style="background-image: url('https://markruler.github.io/images/java/jvm-monitoring/visualgc-with-visualvm.png')"
                    
                
            >
                <div class="post-title">
                    JVM 모니터링
                    
                    <div class="post-subtitle">
                        이게 왜 죽지..?
                    </div>
                    
                    <div class="post-meta">
                        
                        <time itemprop="datePublished">
                            2022-05-23 00:09
                        </time>
                        

                        
                            <i class="material-icons" style="">folder</i>
                                <a href="/categories/wiki">[wiki]</a>
                                &nbsp;
                        

                        
                            <i class="material-icons" style="">label</i>
                            
                                <a href="/tags/java">java</a>
                                &nbsp;
                            
                                <a href="/tags/spring">spring</a>
                                &nbsp;
                            
                                <a href="/tags/tomcat">tomcat</a>
                                &nbsp;
                            
                                <a href="/tags/monitoring">monitoring</a>
                                &nbsp;
                            
                        
                        
                    </div>
                </div>
            </div>
            
            <div class="post-body-wrapper">
                
                <div class="post-body" v-pre>
                
                    <blockquote>
<p><a href="/posts/java/java-timeout-monitoring/">모니터링과 타임아웃의 중요성</a>은 아무리 강조해도 지나치지 않는다.
최근 회사에서 아주 느린 API(약 15초)를 발견했는데 분명 매일 트래픽이 발생하는데도 2년동안 방치되고 있었다.
이런 레거시는 유지 보수할 일이 없다면 개발팀에서도 확인하기 어렵다.
사용자가 리포팅해주길 기대하는 것보다 모니터링 도구를 통해 파악하는 것이 좋다.
심지어 굉장히 간단한 문제여서 파악하고 수정하는 데에 1시간도 안걸렸지만 약 15초 걸리던 API를 100ms까지 줄였다.</p>
</blockquote>
<p>먼저 알아두면 좋은 명령어가 있다.
<code>jps</code>는 JVM Process Status를 출력하는 명령어로
현재 머신에서 실행중인 JVM의 PID나 실행 옵션을 확인할 때 유용하다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2;display:grid;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>&gt; jps -v
</span></span><span style="display:flex;"><span><span style="color:#87ceeb">${</span><span style="color:#eedd82">PID</span><span style="color:#87ceeb">}</span> Bootstrap -Djava...
</span></span></code></pre></div><h1 id="thread-dump">Thread Dump</h1>
<blockquote>
<p>A thread dump is a snapshot of the state of all threads that are part of the process.
(<a href="https://docs.oracle.com/cd/E13150_01/jrockit_jvm/jrockit/geninfo/diagnos/using_threaddumps.html">Oracle Docs</a>)</p>
</blockquote>
<p>쓰레드 덤프(Thread Dump)란 모든 쓰레드 상태의 스냅샷이다.</p>
<p><img src="/images/java/jvm-monitoring/java-thread-state-machine.png" alt="java-thread-state-machine"></p>
<p><em><a href="https://www.uml-diagrams.org/java-thread-uml-state-machine-diagram-example.html">Java Thread States and Life Cycle</a></em></p>
<p>쓰레드 덤프에 메서드 콜 스택 정보를 가진 스택 프레임(Stack Frame)은 없다.</p>
<p><img src="/images/java/jvm-monitoring/debugging-in-intellij.png" alt="Debugging in IntelliJ"></p>
<p><em>IntelliJ에서 디버깅하면 볼 수 있는 스택 프레임</em></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2;display:grid;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Thread1   Thread2   Thread3
</span></span><span style="display:flex;"><span>+-------+ +-------+ +-------+
</span></span><span style="display:flex;"><span>|       | |       | |       |
</span></span><span style="display:flex;"><span>|       | |       | | frame |
</span></span><span style="display:flex;"><span>|       | |       | | frame |
</span></span><span style="display:flex;"><span>| frame | |       | | frame |
</span></span><span style="display:flex;"><span>| frame | | frame | | frame |
</span></span><span style="display:flex;"><span>+-------+ +-------+ +-------+
</span></span></code></pre></div><h2 id="daemon-thread">Daemon Thread</h2>
<ul>
<li>Daemon Thread
<ul>
<li><code>thread.setDaemon(true)</code></li>
<li>Daemon Thread는 JVM 종료 시 자동으로 강제 종료한다.</li>
<li>언제든지 죽어도 상관없는 작업에 사용한다.</li>
<li>Garbage Collector, JMX</li>
</ul>
</li>
<li>Non-Daemon Thread
<ul>
<li><code>thread.setDaemon(false)</code></li>
<li>Non-Daemon Thread가 실행 중인 경우 JVM은 종료되지 않는다.</li>
<li>기본적으로 개발자가 새로 생성하는 쓰레드는 Non-Daemon Thread이다.</li>
<li>메인 쓰레드(Main Thread)도 Non-Daemon Thread다.</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2;display:grid;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#0f0">// java.lang.Thread</span>
</span></span><span style="display:flex;"><span><span style="color:#0f0">/* Whether or not the thread is a daemon thread. */</span>
</span></span><span style="display:flex;"><span><span style="color:#f00">private</span> <span style="color:#ee82ee">boolean</span> daemon = <span style="color:#f00">false</span>;
</span></span></code></pre></div><h2 id="tool">Tool</h2>
<p>나는 주로 쓰레드 간 교착 현상(deadlock)이나
단일 쓰레드의 병목 현상이 의심될 때 사용한다.
하지만 NAVER D2에 올라온 글 &lsquo;<a href="https://d2.naver.com/helloworld/10963">스레드 덤프 분석하기</a>&lsquo;를 보면
이 외의 다양한 상황에서도 쓰레드 덤프를 확인해 볼 수 있다.
쓰레드 덤프 분석이 처음이라면 해당 글을 정독해보자.</p>
<h3 id="jstack">jstack</h3>
<p>쓰레드 스택(Java Thread Stack)을 확인할 수 있는 CLI 도구다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2;display:grid;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>&gt; jstack -l <span style="color:#87ceeb">${</span><span style="color:#eedd82">PID</span><span style="color:#87ceeb">}</span> &gt; thread_dump.txt
</span></span></code></pre></div><h3 id="visualvm">VisualVM</h3>
<p>VisualVM을 사용하면 실시간으로 쓰레드 스택의 상태를 확인할 수 있다.</p>
<p><img src="/images/java/jvm-monitoring/visualvm-tomcat-threads.png" alt="visualvm-tomcat-threads"></p>
<p><em>VisualVM에서 확인한 Thread Stack. OkHttp ConnectionPool이 여러 개 생긴 것으로 문제가 발생했었다.</em></p>
<p>공식 홈페이지에서 다운로드한 후 <code>bin</code> 디렉토리의 실행 파일을 실행하면 된다.
실행하면 로컬 환경의 모든 JVM 프로세스를 확인할 수 있다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2;display:grid;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>bin/visualvm
</span></span></code></pre></div><p>IntelliJ 플러그인 <a href="https://plugins.jetbrains.com/plugin/7115-visualvm-launcher">VisualVM Launcher</a>도 있긴 하지만,
기본적으로 실행했을 때 모든 JVM 프로세스를 확인할 수 있어서
VisualVM을 사용하는 데에 큰 불편함이 없었다.</p>
<h1 id="heap-dump">Heap Dump</h1>
<blockquote>
<p>A heap dump is a snapshot of all the objects in the Java Virtual Machine (JVM) heap at a certain point in time.
(<a href="https://docs.oracle.com/javase/8/docs/technotes/guides/visualvm/heapdump.html">Oracle Docs</a>)</p>
</blockquote>
<p>힙 덤프(Heap Dump)란 JVM 힙의 모든 Object를 담은 스냅샷이다.</p>
<h2 id="outofmemoryerror">OutOfMemoryError</h2>
<p>JVM 실행 시 아래 옵션을 추가하면 <code>OutOfMemoryError</code> 발생으로 JVM이 종료될 때 힙 덤프를 생성한다.</p>
<ul>
<li><code>-XX:HeapDumpPath</code>를 생략하면 Java Process를 실행시킨 곳에 <code>java_pid&lt;pid&gt;.hprof</code> 형태로 파일이 생성된다.
<blockquote>
<p>By default the heap dump is created in a file called java_pid.hprof in the working directory of the VM. - <a href="https://docs.oracle.com/javase/8/docs/technotes/guides/troubleshoot/clopts001.html">Oracle Docs</a></p>
</blockquote>
</li>
<li><code>-XX:+PrintClassHistogramAfterFullGC</code>, <code>-XX:+PrintClassHistogramBeforeFullGC</code> 등의 옵션으로
Full GC 전후의 메모리 상태를 간략히 덤프할 수 있다.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2;display:grid;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>-XX:+HeapDumpOnOutOfMemoryError <span style="color:#87ceeb">\
</span></span></span><span style="display:flex;"><span><span style="color:#87ceeb"></span>-XX:HeapDumpPath=jvm.hprof
</span></span></code></pre></div><h2 id="tool-1">Tool</h2>
<p><code>OutOfMemoryError</code>가 발생한 게 아니라면 <code>jmap</code>을 사용해서 힙 덤프를 확인할 수 있다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2;display:grid;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#0f0"># jmap -dump:format=b,file=/path/app.hprof ${PID}</span>
</span></span><span style="display:flex;"><span>jmap -dump:file=/path/app.hprof <span style="color:#87ceeb">${</span><span style="color:#eedd82">PID</span><span style="color:#87ceeb">}</span>
</span></span><span style="display:flex;"><span>Dumping heap to /path/app.hprof ...
</span></span><span style="display:flex;"><span>Heap dump file created
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt; file /path/app.hprof
</span></span><span style="display:flex;"><span>app.hprof: Java HPROF dump, created Tue May <span style="color:#f60">17</span> 01:15:39 <span style="color:#f60">2022</span>
</span></span></code></pre></div><h3 id="eclipse-memory-analyzer-mat">Eclipse Memory Analyzer (MAT)</h3>
<p><a href="https://www.eclipse.org/mat/">MAT</a>는 힙 덤프를 분석할 수 있게 도와주는 프로그램이다.</p>
<ul>
<li>JDK를 찾지 못하는 경우 아래와 같이 옵션을 추가한다.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2;display:grid;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#0f0"># ${MAT_HOME}/MemoryAnalyzer.ini</span>
</span></span><span style="display:flex;"><span>-vm
</span></span><span style="display:flex;"><span><span style="color:#87ceeb">${</span><span style="color:#eedd82">JAVA_HOME</span><span style="color:#87ceeb">}</span>/bin
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#0f0"># -vmargs 보다 위에 추가해야 한다.</span>
</span></span><span style="display:flex;"><span>-vmargs
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><p>기본 Heap Size가 1024m이다. Heap Dump 파일이 이보다 큰 경우 Parsing할 때 아래와 같은 에러가 발생한다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2;display:grid;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>An internal error occurred during:
</span></span><span style="display:flex;"><span>    <span style="color:#87ceeb">&#34;Parsing heap dump from &#39;/path/java_pid1234.hprof&#39;&#34;</span>.
</span></span><span style="display:flex;"><span>Java heap space
</span></span></code></pre></div><p>설정 파일에 JVM 옵션을 추가하면 확인할 수 있다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2;display:grid;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#0f0"># ${MAT_HOME}/MemoryAnalyzer.ini</span>
</span></span><span style="display:flex;"><span>-vmargs
</span></span><span style="display:flex;"><span><span style="color:#0f0">#-Xmx1024m</span>
</span></span><span style="display:flex;"><span>-Xms6g
</span></span><span style="display:flex;"><span>-Xmx6g
</span></span></code></pre></div><h3 id="visualvm-1">VisualVM</h3>
<p><a href="https://visualvm.github.io/download.html">VisualVM</a>은 애플리케이션을 <strong>실시간으로 분석</strong>하는 데 주로 사용한다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2;display:grid;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#0f0"># $VISUALVM_HOME/etc/visualvm.conf</span>
</span></span><span style="display:flex;"><span><span style="color:#0f0"># Default location of JDK:</span>
</span></span><span style="display:flex;"><span><span style="color:#0f0">#</span>
</span></span><span style="display:flex;"><span><span style="color:#0f0"># It can be overridden on command line by using --jdkhome &lt;dir&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#0f0"># Be careful when changing jdkhome.</span>
</span></span><span style="display:flex;"><span><span style="color:#0f0"># There are two VisualVM launchers for Windows (32-bit and 64-bit) and</span>
</span></span><span style="display:flex;"><span><span style="color:#0f0"># installer points to one of those in the VisualVM application shortcut </span>
</span></span><span style="display:flex;"><span><span style="color:#0f0"># based on the Java version selected at installation time.</span>
</span></span><span style="display:flex;"><span><span style="color:#0f0">#</span>
</span></span><span style="display:flex;"><span><span style="color:#0f0">#visualvm_jdkhome=&#34;/path/to/jdk&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#eedd82">visualvm_jdkhome</span>=<span style="color:#87ceeb">&#34;</span><span style="color:#eedd82">$JAVA_HOME</span><span style="color:#87ceeb">&#34;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2;display:grid;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#0f0"># 실행</span>
</span></span><span style="display:flex;"><span>./bin/visualvm
</span></span></code></pre></div><p>아래 기능으로 힙 덤프를 간략히 확인할 수도 있다.
하지만 기능이 다양한 <a href="#eclipse-memory-analyzer-mat">MAT</a>가 있기 때문에
VisualVM은 실시간으로 확인하는 용도로 사용한다.</p>
<ul>
<li><code>File &gt; Load &gt; *.hprof</code></li>
</ul>
<p><img src="/images/java/jvm-monitoring/visualvm-heap-dump.png" alt="visualvm-heap-dump"></p>
<p><em>VisuamVM에서 확인한 Heap Dump</em></p>
<p>Remote에서 모니터링하기 위해서는 JVM 애플리케이션에 JMX 옵션을 추가해야 한다.
<a href="https://archive.apache.org/dist/tomcat/">Apache Tomcat</a>을 사용한다면 아래와 같이 추가한다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2;display:grid;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#0f0"># Tomcat 다운로드</span>
</span></span><span style="display:flex;"><span>curl -LO https://archive.apache.org/dist/tomcat/tomcat-8/v8.5.41/bin/extras/catalina-jmx-remote.jar
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2;display:grid;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#87ceeb">${</span><span style="color:#eedd82">CATALINA_HOME</span><span style="color:#87ceeb">}</span>/bin/catalina.sh version
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2;display:grid;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#87ceeb">${</span><span style="color:#eedd82">CATALINA_HOME</span><span style="color:#87ceeb">}</span>/bin/catalina.sh start <span style="color:#87ceeb">\
</span></span></span><span style="display:flex;"><span><span style="color:#87ceeb"></span>  -Dcom.sun.management.jmxremote <span style="color:#87ceeb">\
</span></span></span><span style="display:flex;"><span><span style="color:#87ceeb"></span>  -Dcom.sun.management.jmxremote.local.only=false <span style="color:#87ceeb">\
</span></span></span><span style="display:flex;"><span><span style="color:#87ceeb"></span>  -Dcom.sun.management.jmxremote.port=<span style="color:#f60">1099</span> <span style="color:#87ceeb">\
</span></span></span><span style="display:flex;"><span><span style="color:#87ceeb"></span>  -Dcom.sun.management.jmxremote.rmi.port=<span style="color:#f60">1099</span> <span style="color:#87ceeb">\
</span></span></span><span style="display:flex;"><span><span style="color:#87ceeb"></span>
</span></span><span style="display:flex;"><span>  -Dcom.sun.management.jmxremote.ssl=false <span style="color:#87ceeb">\
</span></span></span><span style="display:flex;"><span><span style="color:#87ceeb"></span>
</span></span><span style="display:flex;"><span>  -Dcom.sun.management.jmxremote.authenticate=false <span style="color:#87ceeb">\
</span></span></span><span style="display:flex;"><span><span style="color:#87ceeb"></span>  <span style="color:#0f0"># -Dcom.sun.management.jmxremote.authenticate=true \</span>
</span></span><span style="display:flex;"><span>  <span style="color:#0f0"># -Dcom.sun.management.jmxremote.password.file=$CATALINA_BASE/conf/jmxremote.password \</span>
</span></span><span style="display:flex;"><span>  <span style="color:#0f0"># -Dcom.sun.management.jmxremote.access.file=$CATALINA_BASE/conf/jmxremote.access \</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#0f0"># -Djava.rmi.server.hostname=${REAL_HOST} \</span>
</span></span><span style="display:flex;"><span>  -Djava.rmi.server.hostname=255.255.255.255 <span style="color:#87ceeb">\
</span></span></span><span style="display:flex;"><span><span style="color:#87ceeb"></span>
</span></span><span style="display:flex;"><span>  -jar
</span></span></code></pre></div><p>이후 VisualVM에서 다음과 같이 설정한다.</p>
<blockquote>
<p>File &gt; Add JMX Connection</p>
</blockquote>
<p><img src="/images/java/jvm-monitoring/visualvm-file-add-jmx-connection.png" alt="File &gt; Add JMX Connection"></p>
<p>JVM 옵션으로 추가한 RMI(Remote Method Invocation) HOST와 PORT를 입력한다.</p>
<p><img src="/images/java/jvm-monitoring/visualvm-setting-jmx-connection.png" alt="Setting JMX Connection"></p>
<p>추가하면 다음과 같이 스레드를 실시간으로 모니터링 할 수 있다.
스레드와 힙 메모리의 스냅샷을 저장할 수도 있다.</p>
<p><img src="/images/java/jvm-monitoring/visualvm-jmx-monitoring.png" alt="Setting JMX Connection"></p>
<p>설정만 한다면 여러 호스트를 모니터링 할 수 있다.</p>
<p><img src="/images/java/jvm-monitoring/visualvm-double-jmx-monitoring.png" alt="Setting JMX Connection"></p>
<h1 id="gc-monitoring">GC Monitoring</h1>
<p>GC 모니터링이란 JVM이 어떻게 GC를 수행하고 있는지 알아내는 과정을 말한다.</p>
<h2 id="tool-2">Tool</h2>
<p>처음이라면 NAVER D2에 올라온 글
&lsquo;<a href="https://d2.naver.com/helloworld/6043">Garbage Collection 모니터링 방법</a>&lsquo;이 굉장히 도움된다.</p>
<h3 id="jstat">jstat</h3>
<ul>
<li>JVM Statistics Monitoring</li>
<li><a href="https://docs.oracle.com/javase/8/docs/technotes/tools/unix/jstat.html">공식 문서</a></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2;display:grid;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#0f0"># 1초마다 gc 확인</span>
</span></span><span style="display:flex;"><span>&gt; jstat -gc &lt;PID&gt; <span style="color:#f60">1000</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2;display:grid;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>&gt; jstat -options
</span></span></code></pre></div><table>
  <thead>
      <tr>
          <th>옵션</th>
          <th>기능</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>gc</strong></td>
          <td>각 힙(heap) 영역의 현재 크기와 현재 사용량(Eden 영역, Survivor 영역, Old 영역등), 총 GC 수행 횟수, 누적 GC 소요 시간을 보여 준다.</td>
      </tr>
      <tr>
          <td><strong>gccapactiy</strong></td>
          <td>각 힙 영역의 최소 크기(ms), 최대 크기(mx), 현재 크기, 각 영역별 GC 수행 횟수를 알 수 있는 정보를 보여 준다. 단, 현재 사용량과 누적 GC 소요 시간은 알 수 없다.</td>
      </tr>
      <tr>
          <td><strong>gccause</strong></td>
          <td>-gcutil 옵션이 제공하는 정보와 함께 마지막 GC 원인과 현재 발생하고 있는 GC의 원인을 알 수 있는 정보를 보여 준다.</td>
      </tr>
      <tr>
          <td>gcnew</td>
          <td>New 영역에 대한 GC 수행 정보를 보여 준다.</td>
      </tr>
      <tr>
          <td>gcnewcapacity</td>
          <td>New 영역의 크기에 대한 통계 정보를 보여 준다.</td>
      </tr>
      <tr>
          <td>gcold</td>
          <td>Old 영역에 대한 GC 수행 정보를 보여 준다.</td>
      </tr>
      <tr>
          <td>gcoldcapacity</td>
          <td>Old 영역의 크기에 대한 통계 정보를 보여 준다.</td>
      </tr>
      <tr>
          <td>gcpermcapacity</td>
          <td>Permanent 영역에 대한 통계 정보를 보여 준다.</td>
      </tr>
      <tr>
          <td><strong>gcutil</strong></td>
          <td>각 힙 영역에 대한 사용 정도를 백분율로 보여 준다. 아울러 총 GC 수행 횟수와 누적 GC 시간을 알 수 있다.</td>
      </tr>
  </tbody>
</table>
<h3 id="visual-gc">Visual GC</h3>
<p>JVM이 어떻게 GC를 수행하고 있는지 확인할 수 있다.</p>
<p><img src="/images/java/jvm-monitoring/visualgc-plugin.png" alt="VisualGC Plugin"></p>
<p><em>VisualVM의 Tools &gt; Plugins에서 다운로드 할 수 있다.</em></p>
<p><img src="/images/java/jvm-monitoring/visualgc-with-visualvm.png" alt="visualgc-with-visualvm"></p>
<h1 id="함께-사용하는-도구들">함께 사용하는 도구들</h1>
<h2 id="jdk-tools">JDK Tools</h2>
<ul>
<li><a href="https://docs.oracle.com/javase/8/docs/technotes/tools/index.html">JDK Tools and Utilities</a></li>
</ul>
<p><img src="/images/java/java-conceptual-diagram.png" alt="Java Platform Standard Edition 8 Documentation"></p>
<p><em><a href="https://docs.oracle.com/javase/8/docs/">Java Platform Standard Edition 8 Documentation</a></em></p>
<ul>
<li>jcmd: 성능 관련 카운터 조회</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2;display:grid;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>&gt; jcmd <span style="color:#87ceeb">${</span><span style="color:#eedd82">PID</span><span style="color:#87ceeb">}</span> PerfCounter.print
</span></span><span style="display:flex;"><span>java.threads.daemon=<span style="color:#f60">42</span>
</span></span><span style="display:flex;"><span>java.threads.live=<span style="color:#f60">49</span>
</span></span><span style="display:flex;"><span>java.threads.livePeak=<span style="color:#f60">52</span>
</span></span><span style="display:flex;"><span>java.threads.started=<span style="color:#f60">3951</span>
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><ul>
<li>jmap: JVM Heap 조회</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2;display:grid;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>&gt; jmap -heap <span style="color:#87ceeb">${</span><span style="color:#eedd82">PID</span><span style="color:#87ceeb">}</span>
</span></span><span style="display:flex;"><span>Attaching to process ID 3838860, please wait...
</span></span><span style="display:flex;"><span>Debugger attached successfully.
</span></span><span style="display:flex;"><span>Server compiler detected.
</span></span><span style="display:flex;"><span>JVM version is 25.292-b10
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>using thread-local object allocation.
</span></span><span style="display:flex;"><span>Parallel GC with <span style="color:#f60">10</span> thread(s)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Heap Configuration:
</span></span><span style="display:flex;"><span>   <span style="color:#eedd82">MinHeapFreeRatio</span>         = <span style="color:#f60">0</span>
</span></span><span style="display:flex;"><span>   <span style="color:#eedd82">MaxHeapFreeRatio</span>         = <span style="color:#f60">100</span>
</span></span><span style="display:flex;"><span>   <span style="color:#eedd82">MaxHeapSize</span>              = <span style="color:#f60">8348762112</span> (7962.0MB)
</span></span><span style="display:flex;"><span>   <span style="color:#eedd82">NewSize</span>                  = <span style="color:#f60">174063616</span> (166.0MB)
</span></span><span style="display:flex;"><span>   <span style="color:#eedd82">MaxNewSize</span>               = <span style="color:#f60">2782920704</span> (2654.0MB)
</span></span><span style="display:flex;"><span>   <span style="color:#eedd82">OldSize</span>                  = <span style="color:#f60">348127232</span> (332.0MB)
</span></span><span style="display:flex;"><span>   <span style="color:#eedd82">NewRatio</span>                 = <span style="color:#f60">2</span>
</span></span><span style="display:flex;"><span>   <span style="color:#eedd82">SurvivorRatio</span>            = <span style="color:#f60">8</span>
</span></span><span style="display:flex;"><span>   <span style="color:#eedd82">MetaspaceSize</span>            = <span style="color:#f60">21807104</span> (20.796875MB)
</span></span><span style="display:flex;"><span>   <span style="color:#eedd82">CompressedClassSpaceSize</span> = <span style="color:#f60">1073741824</span> (1024.0MB)
</span></span><span style="display:flex;"><span>   <span style="color:#eedd82">MaxMetaspaceSize</span>         = <span style="color:#f60">17592186044415</span> MB
</span></span><span style="display:flex;"><span>   <span style="color:#eedd82">G1HeapRegionSize</span>         = <span style="color:#f60">0</span> (0.0MB)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Heap Usage:
</span></span><span style="display:flex;"><span>PS Young Generation
</span></span><span style="display:flex;"><span>Eden Space:
</span></span><span style="display:flex;"><span>   <span style="color:#eedd82">capacity</span> = <span style="color:#f60">2094006272</span> (1997.0MB)
</span></span><span style="display:flex;"><span>   <span style="color:#eedd82">used</span>     = <span style="color:#f60">398200696</span> (379.75377655029297MB)
</span></span><span style="display:flex;"><span>   <span style="color:#eedd82">free</span>     = <span style="color:#f60">1695805576</span> (1617.246223449707MB)
</span></span><span style="display:flex;"><span>   19.0162131472355% used
</span></span><span style="display:flex;"><span>From Space:
</span></span><span style="display:flex;"><span>   <span style="color:#eedd82">capacity</span> = <span style="color:#f60">82837504</span> (79.0MB)
</span></span><span style="display:flex;"><span>   <span style="color:#eedd82">used</span>     = <span style="color:#f60">0</span> (0.0MB)
</span></span><span style="display:flex;"><span>   <span style="color:#eedd82">free</span>     = <span style="color:#f60">82837504</span> (79.0MB)
</span></span><span style="display:flex;"><span>   0.0% used
</span></span><span style="display:flex;"><span>To Space:
</span></span><span style="display:flex;"><span>   <span style="color:#eedd82">capacity</span> = <span style="color:#f60">78643200</span> (75.0MB)
</span></span><span style="display:flex;"><span>   <span style="color:#eedd82">used</span>     = <span style="color:#f60">0</span> (0.0MB)
</span></span><span style="display:flex;"><span>   <span style="color:#eedd82">free</span>     = <span style="color:#f60">78643200</span> (75.0MB)
</span></span><span style="display:flex;"><span>   0.0% used
</span></span><span style="display:flex;"><span>PS Old Generation
</span></span><span style="display:flex;"><span>   <span style="color:#eedd82">capacity</span> = <span style="color:#f60">467140608</span> (445.5MB)
</span></span><span style="display:flex;"><span>   <span style="color:#eedd82">used</span>     = <span style="color:#f60">107232904</span> (102.26526641845703MB)
</span></span><span style="display:flex;"><span>   <span style="color:#eedd82">free</span>     = <span style="color:#f60">359907704</span> (343.23473358154297MB)
</span></span><span style="display:flex;"><span>   22.955166423896078% used
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f60">47952</span> interned Strings occupying <span style="color:#f60">5230216</span> bytes.
</span></span></code></pre></div><ul>
<li>jhat: Java Heap Analyzer Tool
<ul>
<li>JDK 9에서 제거되었다.</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2;display:grid;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>&gt; jhat -J-Xmx6g -port <span style="color:#f60">7000</span> /path/app.hprof
</span></span></code></pre></div><h2 id="datadog">Datadog</h2>
<ul>
<li><a href="https://docs.datadoghq.com/tracing/profiler/enabling/java/">Enabling the Java Profiler</a></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2;display:grid;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>-Ddd.profiling.enabled=true <span style="color:#87ceeb">\
</span></span></span><span style="display:flex;"><span><span style="color:#87ceeb"></span>-XX:FlightRecorderOptions=<span style="color:#eedd82">stackdepth</span>=<span style="color:#f60">256</span>
</span></span></code></pre></div><h2 id="이-외의-도구들">이 외의 도구들</h2>
<ul>
<li><a href="https://www.oracle.com/java/technologies/jdk-mission-control.html">JDK Mission Control</a> - Oracle</li>
<li><a href="https://github.com/pinpoint-apm/pinpoint">Pinpoint</a> - NAVER에서 만든 오픈소스 APM</li>
<li><a href="https://www.yourkit.com/java/profiler">Java Profiler Features</a> - YourKit</li>
<li><a href="https://www.ej-technologies.com/products/jprofiler/overview.html">JProfiler</a> (유료)</li>
</ul>
<h1 id="더-읽을-거리">더 읽을 거리</h1>
<p>다른 개발자들의 실제 사례를 보면 얻을 수 있는 인사이트가 많다.</p>
<h2 id="thread-stack">Thread Stack</h2>
<ul>
<li><a href="https://d2.naver.com/helloworld/10963">스레드 덤프 분석하기</a> - NAVER D2</li>
<li><a href="https://dzone.com/articles/how-to-read-a-thread-dump">How to Read a Thread Dump</a> - DZone</li>
<li><a href="https://johngrib.github.io/wiki/jvm-stack/">JVM stack과 frame</a> - 기계인간 John Grib</li>
</ul>
<h2 id="heap-memory">Heap Memory</h2>
<ul>
<li><a href="https://d2.naver.com/helloworld/1326256">하나의 메모리 누수를 잡기까지</a> - NAVER D2</li>
<li><a href="https://techblog.woowahan.com/2628/">도움이 될수도 있는 JVM memory leak 이야기</a> - 우아한 형제들</li>
<li><a href="https://d2.naver.com/helloworld/184615">자바 애플리케이션 성능 튜닝의 도(道)</a> - NAVER D2</li>
<li><a href="https://d2.naver.com/helloworld/1286587">Java 애플리케이션 트러블 슈팅</a> - NAVER D2</li>
<li><a href="https://kwonnam.pe.kr/wiki/java/memory">Java Memory Analysis</a> - 권남</li>
<li><a href="https://www.whatap.io/ko/blog/28/">JVM Crash 문제 해결하기</a> - 와탭</li>
<li><a href="http://honeymon.io/tech/2019/05/30/java-memory-leak-analysis.html">자바 메모리누수(with 힙덤프) 분석하기</a> - 김지헌</li>
<li><a href="https://lng1982.tistory.com/352">Java Heap Dump 를 이용한 문제 해결</a> - 탁구치는 개발자</li>
<li><a href="https://sarc.io/index.php/java/1092-jvm-default-heap-size">JVM의 default Heap Size가 궁금하세요?</a> - 삵(sarc)</li>
<li><a href="https://perfectacle.github.io/2019/04/28/heap-memory-analytics-with-eclipse-mat/">생애 첫 Heap 메모리 분석기</a> - 양권성</li>
<li><a href="https://spoqa.github.io/2012/02/06/eclipse-mat.html">Eclipse Memory Analyzer 소개</a> - spoqa</li>
<li><a href="https://dzone.com/articles/eclipse-mat-incoming-outgoing-references">Eclipse MAT — Incoming, Outgoing References</a> - DZone</li>
<li><a href="https://www.baeldung.com/visualvm-jmx-remote">Remote Monitoring with VisualVM and JMX</a></li>
<li><a href="https://www.lesstif.com/java/apache-tomcat-jmx-monitoring-20776824.html">아파치 톰캣(Apache Tomcat)을 JMX로 Remote Monitoring 하기</a></li>
<li>전문가를 위한 스프링 5 (15장 애플리케이션 모니터링)</li>
</ul>
<h2 id="garbage-collection">Garbage Collection</h2>
<ul>
<li>&lt;<a href="https://www.aladin.co.kr/shop/wproduct.aspx?ISBN=9788979145229">자바 성능을 결정짓는 코딩 습관과 튜닝 이야기</a>&gt;라는
책의 저자가 쓰신 글들은 모두 재밌고 유용하다.
<ul>
<li><a href="https://d2.naver.com/helloworld/6043">Garbage Collection 모니터링 방법</a> - NAVER D2</li>
<li><a href="https://d2.naver.com/helloworld/4717">Garbage Collection과 Statement Pool</a> - NAVER D2
<ul>
<li><a href="https://zzikjh.tistory.com/entry/DBCP-%EC%82%AC%EC%9A%A9%EC%8B%9C-poolPreparedStatements-%EC%86%8D%EC%84%B1%EC%9D%B4-%EC%84%B1%EB%8A%A5%EC%97%90-%EB%AF%B8%EC%B9%98%EB%8A%94-%EC%98%81%ED%96%A5">DBCP 사용시 poolPreparedStatements 속성이 성능에 미치는 영향</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="기타">기타</h2>
<ul>
<li><a href="https://blog.naver.com/pcmola/222064546600">Java 프로파일링 도구</a> - 메이커 꾸러기</li>
<li><a href="https://www.infoq.com/news/2015/12/OpenJDK-9-removal-of-HPROF-jhat/">OpenJDK 9: Life Without HPROF and jhat</a> - InfoQ</li>
<li><a href="https://youtu.be/8wHx31mvSLY">Everything I Ever Learned About JVM Performance Tuning at Twitter</a> - Attila Szegedi</li>
</ul>

                    
                    <HR width="100%" id="EOF">
		    <p style="color:#777;">최종 수정: 2022-05-23</p>
                    
                </div>
            </div>
            
            
            <nav class="post-pagination">

                
                <a class="newer-posts" href="/posts/ci/ci-with-lb/">
			다음글<br>Load Balancer를 활용해서 배포 프로세스를 개선해보자
                </a>
                
                
                
                <a class="older-posts" href="/posts/java/java-timeout-monitoring/">
			이전글<br>모니터링과 타임아웃의 중요성
                </a>
                
            </nav>
            <div class="post-comment-wrapper">
                












            </div>

            





<section class="social-share">
  <ul class="share-icons">
    
    
    <li>
      <a href="https://twitter.com/intent/tweet?hashtags=markruler,dev&amp;url=https%3a%2f%2fmarkruler.github.io%2fposts%2fjava%2fjvm-monitoring%2f&amp;text=JVM%20%eb%aa%a8%eb%8b%88%ed%84%b0%eb%a7%81" target="_blank" rel="noopener" aria-label="Share on Twitter" class="share-btn twitter">
        <svg xmlns:xlink="http://www.w3.org/1999/xlink" id="twitter" viewBox="0 0 48 48" overflow="hidden">
  <defs></defs>
  <g style="pointer-events:all">
    <title style="pointer-events:inherit">bg</title>
    <circle cx="24" cy="24" fill="#1CB7EB" r="24" style="pointer-events:inherit" id="svg_1"></circle>
    <path d="M36.8,15.4C35.9,15.9 34.8,16.2 33.8,16.3C34.9,15.6 35.7,14.5 36.1,13.2C35.1,13.8 34,14.3 32.7,14.6C31.7,13.5 30.4,12.8 28.9,12.8C26,12.8 23.6,15.3 23.6,18.5C23.6,18.9 23.6,19.4 23.7,19.8C19.3,19.6 15.4,17.3 12.8,13.9C12.3,14.7 12.1,15.7 12.1,16.8C12.1,18.8 13,20.5 14.4,21.5C13.5,21.5 12.7,21.2 12,20.8C12,20.8 12,20.9 12,20.9C12,23.6 13.8,25.9 16.2,26.5C15.8,26.6 15.3,26.7 14.8,26.7C14.5,26.7 14.1,26.7 13.8,26.6C14.5,28.9 16.4,30.5 18.7,30.5C16.9,32 14.6,32.9 12.2,32.9C11.8,32.9 11.4,32.9 10.9,32.8C13.2,34.4 16,35.4 19,35.4C28.7,35.4 34,26.8 34,19.3C34,19.1 34,18.8 34,18.6C35.2,17.6 36.1,16.6 36.8,15.4z" fill="#FFFFFF" style="pointer-events:inherit" id="svg_4"></path>
  </g>
</svg>
        <p>Twitter</p>
      </a>
    </li>
    

    
    
    <li>
      <a href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fmarkruler.github.io%2fposts%2fjava%2fjvm-monitoring%2f" target="_blank" rel="noopener" aria-label="Share on Facebook" class="share-btn facebook">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" enable-background="new 0 0 48 48" id="facebook" version="1.1" viewBox="0 0 48 48" xml:space="preserve">
  <circle cx="24" cy="24" fill="#4E71A8" r="24" />
  <path d="M29.9,19.5h-4v-2.6c0-1,0.7-1.2,1.1-1.2c0.5,0,2.8,0,2.8,0v-4.4l-3.9,0c-4.4,0-5.3,3.3-5.3,5.3v2.9h-2.5V24  h2.5c0,5.8,0,12.7,0,12.7h5.3c0,0,0-7,0-12.7h3.6L29.9,19.5z" fill="#FFFFFF" />
</svg>
        <p>Facebook</p>
        </a>
    </li>
    

    
    

    
    

    
    
    <li>
      <a href="mailto:?subject=%ec%9e%84%ec%b0%bd%ec%88%98 - JVM%20%eb%aa%a8%eb%8b%88%ed%84%b0%eb%a7%81.&amp;body=JVM%20%eb%aa%a8%eb%8b%88%ed%84%b0%eb%a7%81%2c%20by%20%ec%9e%84%ec%b0%bd%ec%88%98%0a%ec%9d%b4%ea%b2%8c%20%ec%99%9c%20%ec%a3%bd%ec%a7%80..%3f%0a%0ahttps%3a%2f%2fmarkruler.github.io%2fposts%2fjava%2fjvm-monitoring%2f%0a" target="_blank" class="share-btn email">
        <svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" id="email" overflow="hidden">
  <defs></defs>
  <g style="pointer-events:none">
    <title style="pointer-events:inherit">background</title>
    <rect x="-1" y="-1" width="582" height="402" id="canvas_background" fill="none" style="pointer-events:inherit"></rect>
  </g>
  <g style="pointer-events:all">
    <title style="pointer-events:inherit">Layer 1</title>
    <path d="M16,0C7.163,0 0,7.163 0,16C0,24.836 7.163,32 16,32S32,24.836 32,16C32,7.163 24.837,0 16,0z" fill="#333333" style="pointer-events:inherit" id="svg_2"></path>
    <polygon fill="#FFFFFF" points="6.518,21.815 11.707,15.291 6.518,12.119   " style="pointer-events:inherit" id="svg_4"></polygon>
    <polygon fill="#FFFFFF" points="19.5,15.746 15.989,17.908 12.472,15.758 7.11,22.5 24.867,22.5   " style="pointer-events:inherit" id="svg_5"></polygon>
    <polygon fill="#FFFFFF" points="15.988,16.864 25.482,11.017 25.482,9.5 6.518,9.5 6.518,11.076   " style="pointer-events:inherit" id="svg_6"></polygon>
    <polygon fill="#FFFFFF" points="20.263,15.276 25.482,21.843 25.482,12.062   " style="pointer-events:inherit" id="svg_7"></polygon>
  </g>
</svg>
        <p>Email</p>
      </a>
    </li>
  </ul>
</section>


        </div>
    </div>


                    </div>
            </div><div id="sideContainer" class="side-container">
    
    <a class="a-block nav-head false" href="https://markruler.github.io/">
    
        <div class="nav-title">
            임창수
        </div>
        
        <div class="nav-subtitle">
            What, Why, How.
        </div>
        
    </a>

    <div class="nav-link-list">
        
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/about">
                About
            </a>
            
        
            
            
            
                
            
            
            
            <a class="a-block nav-link-item active" href="/posts">
                Posts
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/categories">
                Categories
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/tags">
                Tags
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/index.xml">
                RSS Feed
            </a>
            
        
    </div>

    
    <button
        class="read-random"
        data-target-prefix="/posts">
        Navigate to Random Post
    </button>

    <div class="nav-footer">
        


Hugo Theme <a style="color: #0054B8; text-decoration: underline;" href="https://github.com/amazingrise/hugo-theme-diary">Diary</a>
by <a style="color: #0054B8; text-decoration: underline;" href="https://risehere.net/">Rise</a>
<br>
Ported from <a style="color: #0054B8; text-decoration: underline;" href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a>'s
<a style="color: #0054B8; text-decoration: underline;" href="https://github.com/SumiMakito/hexo-theme-journal/" target="_blank" rel="noreferrer noopener">Journal.</a> <br>
<br>

&copy;
	
	Im Changsu 2020 - 2024
	

    </div>
    
</div><div id="extraContainer" class="extra-container">
    <div class="toc-wrapper">
        

        
        <div class="toc">


	<div class="toc-content">
	
		
		
		
		<center>- 목차 -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#thread-dump" class="nav-thread-dump">
									Thread Dump
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#daemon-thread" class="nav-daemon-thread">
									Daemon Thread
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#tool" class="nav-tool">
									Tool
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#jstack" class="nav-jstack">
									jstack
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#visualvm" class="nav-visualvm">
									VisualVM
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
								</ul>
							
						
						
						
							<li>
								<a href="#heap-dump" class="nav-heap-dump">
									Heap Dump
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#outofmemoryerror" class="nav-outofmemoryerror">
									OutOfMemoryError
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#tool-1" class="nav-tool-1">
									Tool
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#eclipse-memory-analyzer-mat" class="nav-eclipse-memory-analyzer-mat">
									Eclipse Memory Analyzer (MAT)
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#visualvm-1" class="nav-visualvm-1">
									VisualVM
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
								</ul>
							
						
						
						
							<li>
								<a href="#gc-monitoring" class="nav-gc-monitoring">
									GC Monitoring
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#tool-2" class="nav-tool-2">
									Tool
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#jstat" class="nav-jstat">
									jstat
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#visual-gc" class="nav-visual-gc">
									Visual GC
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
								</ul>
							
						
						
						
							<li>
								<a href="#%ed%95%a8%ea%bb%98-%ec%82%ac%ec%9a%a9%ed%95%98%eb%8a%94-%eb%8f%84%ea%b5%ac%eb%93%a4" class="nav-함께-사용하는-도구들">
									함께 사용하는 도구들
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#jdk-tools" class="nav-jdk-tools">
									JDK Tools
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#datadog" class="nav-datadog">
									Datadog
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%ec%9d%b4-%ec%99%b8%ec%9d%98-%eb%8f%84%ea%b5%ac%eb%93%a4" class="nav-이-외의-도구들">
									이 외의 도구들
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%eb%8d%94-%ec%9d%bd%ec%9d%84-%ea%b1%b0%eb%a6%ac" class="nav-더-읽을-거리">
									더 읽을 거리
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#thread-stack" class="nav-thread-stack">
									Thread Stack
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#heap-memory" class="nav-heap-memory">
									Heap Memory
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#garbage-collection" class="nav-garbage-collection">
									Garbage Collection
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%ea%b8%b0%ed%83%80" class="nav-기타">
									기타
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
        
    </div>
    <div class="pagination">
        <a id="globalBackToTop" class="pagination-action animated-visibility" href="#top"
            :class="{ invisible: scrollY == 0 }">
            <i class="material-icons pagination-action-icon">
                keyboard_arrow_up
            </i>
        </a>
        
        <a type="button" class="pagination-action" id="darkModeToggleButton">
            <span class="material-icons pagination-action-icon" id="darkModeToggleIcon">
                dark_mode
            </span>
        </a>
        
        
    </div>
</div>

<div id="single-column-footer">


Hugo Theme <a style="color: #0054B8; text-decoration: underline;" href="https://github.com/amazingrise/hugo-theme-diary">Diary</a>
by <a style="color: #0054B8; text-decoration: underline;" href="https://risehere.net/">Rise</a>
<br>
Ported from <a style="color: #0054B8; text-decoration: underline;" href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a>'s
<a style="color: #0054B8; text-decoration: underline;" href="https://github.com/SumiMakito/hexo-theme-journal/" target="_blank" rel="noreferrer noopener">Journal.</a> <br>
<br>

&copy;
	
	Im Changsu 2020 - 2024
	
</div>
            </div>
    
    <script src="/js/journal.js"></script><script src="/js/read-random.js"></script>
    </body>
</html>
